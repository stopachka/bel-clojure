{"version":3,"sources":["cljs_test_display/favicon.cljs"],"mappings":";;;;AAMA;;;oCAAA,AAAAA,YAAA,oCAAA,pFAAaC;AAEb,oDAAA,pDAAMC,gHAAsBC;AAA5B,AACE,mDAAA,WAAAC,vDAACC;AAAD,AAAM,sBAAAD,fAAOD;GAAa,AAACG,8CAAM,AAAUH;;AAE7C,+CAAA,/CAAMI;AAAN,AACE,OAACC,gBACA,AAACC,+CACA,WAAKC;AAAL,AACE,IAAAC,qBAAe,AAAOD;AAAtB,AAAA,oBAAAC;AAAA,AAAA,UAAAA,NAAWC;AAAX,AACE,sBAAA,WAAAC,1BAACC;AAAD,AAAO,oDAAA,OAAAD,pDAACE;GAAY,uDAAA,vDAACC,mDAAaJ;;AADpC;;GAEF,AAACV,kDAAqB,8BAAA,9BAACe;;AAE3B,4CAAA,5CAAMC,gGAAYR;AAAlB,AACE,CAAM,AAAMA,OAAGT;;AACf,SAAA,RAAM,AAAOS;;AACb,UAAA,TAAM,AAAQA;;AACd,iBAAA,TAAM,AAAQA;;AAEhB,gDAAA,hDAAMS;AAAN,AACE,IAAAC,qBAAiB,AAACE,oBAAgBrB;AAAlC,AAAA,oBAAAmB;AAAA,cAAAA,VAASC;AAAT,AACEA;;AACA,IAAAD,yBAAiB,AAACb;AAAlB,AAAA,oBAAAa;AAAA,cAAAA,VAASC;AAAT,AACE,AAAI,AAACH,0CAAWG;;AACZA;;AACJ,IAAMA,UAAQ,mBAAA,nBAACE;AAAf,AACE,AAACL,0CAAWG;;2EACR,AAACG,tDACD,6EAAA,7EAACC,rBACD,AAACC,0GAAiBL;;AACtBA;;;;AAER,2CAAA,3CAAMM,8FAAgBC,MAAMC;AAA5B,AACE,IAAMC,MAAI,mBAAA,SAAA,5BAACP,uCAAoCM,gBAAaA;AAA5D,AACE,IAAME,YAAI,eAAA,fAAaD;AAAvB,AACE,CAAM,AAAaC,sBAAKH;;AACxB,mBAAA,IAAA,vBAAWG,2BAAQF,KAAKA;;AAC1B,OAAYC;;AAEhB,4CAAA,5CAAME,gGAAiBJ;AAAvB,AACE,QAAM,AAAQ,AAACT,uDAAiB,+CAAA,/CAACQ,yCAAeC;;AAElD,kCAAA,lCAAMK;AAAN,AAAe,iDAAA,1CAACD;;AAEhB,gCAAA,hCAAME;AAAN,AAAa,iDAAA,1CAACF","names":["js/goog.define","cljs-test-display.favicon/link-id","cljs-test-display.favicon/html-collection->seq","html-coll","p1__22231#","cljs.core.map","cljs.core.range","cljs-test-display.favicon/find-existing-link","cljs.core/first","cljs.core.filter","l","temp__5804__auto__","rel","p1__22259#","cljs.core/some","cljs.core._EQ_","clojure.string.split","goog.dom/getElementsByTagName","cljs-test-display.favicon/init-link!","cljs-test-display.favicon/get-or-create!","temp__5802__auto__","favicon","goog.dom/getElement","goog.dom/createDom","goog.dom/getDocument","cljs_test_display.favicon.goog$module$goog$object.get","goog.dom/appendChild","cljs-test-display.favicon/color-data-url","color","size","cvs","ctx","cljs-test-display.favicon/change-to-color","cljs-test-display.favicon/green","cljs-test-display.favicon/red"],"sourcesContent":["(ns cljs-test-display.favicon\n  (:require\n   [clojure.string :as string]\n   [goog.object :as gobj]\n   [goog.dom :as gdom]))\n\n(goog-define link-id \"cljs-test-favicon\")\n\n(defn html-collection->seq [html-coll]\n  (map #(.item html-coll %) (range (.-length html-coll))))\n\n(defn find-existing-link []\n  (first\n   (filter\n    (fn [l]\n      (when-let [rel (.-rel l)]\n        (some #(= \"icon\" %) (string/split rel #\"\\s\"))))\n    (html-collection->seq (gdom/getElementsByTagName \"link\")))))\n\n(defn init-link! [l]\n  (set! (.-id l) link-id)\n  (set! (.-rel l) \"shortcut icon\")\n  (set! (.-type l) \"image/png\")\n  (set! (.-href l) \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAIElEQVQ4T2NMS0v7z0ABYBw1gGE0DBhGwwCYh4ZBOgAAcQUjIUXh8RYAAAAASUVORK5CYII=\"))\n\n(defn get-or-create! []\n  (if-let [favicon (gdom/getElement link-id)]\n    favicon\n    (if-let [favicon (find-existing-link)]\n      (do (init-link! favicon)\n          favicon)\n      (let [favicon (gdom/createDom \"link\")]\n        (init-link! favicon)\n        (-> (gdom/getDocument)\n            (gobj/get \"head\")\n            (gdom/appendChild favicon))\n        favicon))))\n\n(defn color-data-url [color size]\n  (let [cvs (gdom/createDom \"canvas\" #js {:width size :height size})]\n    (let [ctx (.getContext cvs \"2d\")]\n      (set! (.-fillStyle ctx) color)\n      (.fillRect ctx 0 0 size size))\n    (.toDataURL cvs)))\n\n(defn change-to-color [color]\n  (set! (.-href (get-or-create!)) (color-data-url color 16)))\n\n(defn green [] (change-to-color \"#0d0\"))\n\n(defn red [] (change-to-color \"#d00\"))\n"]}